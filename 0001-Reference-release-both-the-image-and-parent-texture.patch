From 6826b54dde3dbeb89846732c0b660e0522f2421c Mon Sep 17 00:00:00 2001
From: Nicolas Capens <capn@google.com>
Date: Thu, 13 Nov 2014 22:55:51 -0500
Subject: [PATCH 1/5] Reference/release both the image and parent texture.

BUG=18381089

Change-Id: I379deb9a80eef4cc75082a58bfd14e588d7a93a1
---
 src/OpenGL/libGLES_CM/Image.cpp      | 4 ++--
 src/OpenGL/libGLES_CM/libGLES_CM.cpp | 6 +++---
 src/OpenGL/libGLESv2/Image.cpp       | 4 ++--
 src/Radiance/libRAD/Image.cpp        | 4 ++--
 4 files changed, 9 insertions(+), 9 deletions(-)

diff --git a/src/OpenGL/libGLES_CM/Image.cpp b/src/OpenGL/libGLES_CM/Image.cpp
index 981cfc9..261ab90 100644
--- a/src/OpenGL/libGLES_CM/Image.cpp
+++ b/src/OpenGL/libGLES_CM/Image.cpp
@@ -54,7 +54,7 @@ namespace es1
 	{
 		if(parentTexture)
 		{
-			return parentTexture->addRef();
+			parentTexture->addRef();
 		}
 
 		sw::atomicIncrement(&referenceCount);
@@ -64,7 +64,7 @@ namespace es1
 	{
 		if(parentTexture)
 		{
-			return parentTexture->release();
+			parentTexture->release();
 		}
 
 		if(referenceCount > 0)
diff --git a/src/OpenGL/libGLES_CM/libGLES_CM.cpp b/src/OpenGL/libGLES_CM/libGLES_CM.cpp
index 62359b9..0374df9 100644
--- a/src/OpenGL/libGLES_CM/libGLES_CM.cpp
+++ b/src/OpenGL/libGLES_CM/libGLES_CM.cpp
@@ -466,13 +466,13 @@ void GL_APIENTRY glBindRenderbufferOES(GLenum target, GLuint renderbuffer)
 
         if(context)
         {
-			if (renderbuffer != 0 && !context->getRenderbuffer(renderbuffer))
-			{
+			if(renderbuffer != 0 && !context->getRenderbuffer(renderbuffer))
+			{
 				// [OpenGL ES 2.0.25] Section 4.4.3 page 112
 				// [OpenGL ES 3.0.2] Section 4.4.2 page 201
 				// 'renderbuffer' must be either zero or the name of an existing renderbuffer object of
 				// type 'renderbuffertarget', otherwise an INVALID_OPERATION error is generated.
-				return error(GL_INVALID_OPERATION);
+				return error(GL_INVALID_OPERATION);
 			}
 
             context->bindRenderbuffer(renderbuffer);
diff --git a/src/OpenGL/libGLESv2/Image.cpp b/src/OpenGL/libGLESv2/Image.cpp
index 2c5dcda..038d18e 100644
--- a/src/OpenGL/libGLESv2/Image.cpp
+++ b/src/OpenGL/libGLESv2/Image.cpp
@@ -53,7 +53,7 @@ namespace es2
 	{
 		if(parentTexture)
 		{
-			return parentTexture->addRef();
+			parentTexture->addRef();
 		}
 
 		sw::atomicIncrement(&referenceCount);
@@ -63,7 +63,7 @@ namespace es2
 	{
 		if(parentTexture)
 		{
-			return parentTexture->release();
+			parentTexture->release();
 		}
 
 		if(referenceCount > 0)
diff --git a/src/Radiance/libRAD/Image.cpp b/src/Radiance/libRAD/Image.cpp
index 4f41dc0..9b62b4b 100644
--- a/src/Radiance/libRAD/Image.cpp
+++ b/src/Radiance/libRAD/Image.cpp
@@ -53,7 +53,7 @@ namespace rad
 	{
 		if(parentTexture)
 		{
-			return parentTexture->addRef();
+			parentTexture->addRef();
 		}
 
 		sw::atomicIncrement(&referenceCount);
@@ -63,7 +63,7 @@ namespace rad
 	{
 		if(parentTexture)
 		{
-			return parentTexture->release();
+			parentTexture->release();
 		}
 
 		if(referenceCount > 0)
-- 
1.8.5.2.msysgit.0

