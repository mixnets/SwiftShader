{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "f7de6842_9c476df6",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 12,
      "author": {
        "id": 9669
      },
      "writtenOn": "2022-09-19T14:17:27Z",
      "side": 1,
      "message": "Below you said this is a compile error, but this sentence implies that the error would happen at runtime?",
      "range": {
        "startLine": 12,
        "startChar": 26,
        "endLine": 12,
        "endChar": 62
      },
      "revId": "db73a595754089414463a24eba20659617203087",
      "serverId": "aea13c4a-0b89-3eca-aee9-e193b1b77aa4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d4063bd8_aad48167",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 12,
      "author": {
        "id": 5050
      },
      "writtenOn": "2022-09-19T14:25:54Z",
      "side": 1,
      "message": "It\u0027s a compile time error. This is the current behavior on compilers which allow this to work.",
      "parentUuid": "f7de6842_9c476df6",
      "range": {
        "startLine": 12,
        "startChar": 26,
        "endLine": 12,
        "endChar": 62
      },
      "revId": "db73a595754089414463a24eba20659617203087",
      "serverId": "aea13c4a-0b89-3eca-aee9-e193b1b77aa4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "07289c4c_a4d1bdd6",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 18,
      "author": {
        "id": 9669
      },
      "writtenOn": "2022-09-19T14:17:27Z",
      "side": 1,
      "message": "Can you specify which compiler (and version), and what the error message from it was exactly? Would help me understand what this fixes.",
      "range": {
        "startLine": 17,
        "startChar": 0,
        "endLine": 18,
        "endChar": 31
      },
      "revId": "db73a595754089414463a24eba20659617203087",
      "serverId": "aea13c4a-0b89-3eca-aee9-e193b1b77aa4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bc781be9_39053b0f",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 18,
      "author": {
        "id": 5050
      },
      "writtenOn": "2022-09-19T14:25:54Z",
      "side": 1,
      "message": "```\n\u003e gcc --version\ngcc (Debian 12.2.0-1) 12.2.0\nCopyright (C) 2022 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n```\n\nExample of an error:\n```\nIn member function ‘T\u0026 sw::vec\u003cT, 4\u003e::operator[](int) [with T \u003d float]’,\n    inlined from ‘rr::Float sw::PixelRoutine::blendConstant(vk::Format, int, BlendFactorModifier)’ at /usr/local/google/home/sugoi/SwiftShader/src/Pipeline/PixelRoutine.cpp:1765:43:\n/usr/local/google/home/sugoi/SwiftShader/src/Pipeline/../System/Types.hpp:143:25: error: array subscript 0 is outside array bounds of ‘sw::float4 [0]’ [-Werror\u003darray-bounds]\n  143 |                 return v[i];\n      |     \n```",
      "parentUuid": "07289c4c_a4d1bdd6",
      "range": {
        "startLine": 17,
        "startChar": 0,
        "endLine": 18,
        "endChar": 31
      },
      "revId": "db73a595754089414463a24eba20659617203087",
      "serverId": "aea13c4a-0b89-3eca-aee9-e193b1b77aa4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "348d4697_0ad36c71",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 18,
      "author": {
        "id": 5050
      },
      "writtenOn": "2022-09-19T14:27:22Z",
      "side": 1,
      "message": "My understanding is that the compiler is expecting `vec\u003cT, 4\u003e` to be an array, while it\u0027s just a class with an overloaded `operator[]`.",
      "parentUuid": "bc781be9_39053b0f",
      "range": {
        "startLine": 17,
        "startChar": 0,
        "endLine": 18,
        "endChar": 31
      },
      "revId": "db73a595754089414463a24eba20659617203087",
      "serverId": "aea13c4a-0b89-3eca-aee9-e193b1b77aa4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b5ed029f_97087e9e",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 18,
      "author": {
        "id": 9669
      },
      "writtenOn": "2022-09-19T16:20:42Z",
      "side": 1,
      "message": "I was able to reduce and reproduce this problem on Compiler Explorer: https://godbolt.org/z/1f6W1GWeK\n\nThis issue only occurs starting with GCC 12.1, and only when -O2 is defined (doesn\u0027t reproduce at -O1). Basically, when optimizations are enabled, the operator[] call gets inlined, and GCC warns about out of bounds access. This seems related to casting \u002732\u0027 as the struct pointer value; casting to 0 (like offsetof does) makes this go away. Interestingly, using any negative value also makes this go away.\n\nI don\u0027t know exactly _why_ GCC is complaining - from what I\u0027ve read online, the rules around this are quite complex. I\u0027ve also seen that there are false positives in certain cases. So IMHO, I would try to disable this warning when using this macro, as it\u0027s a false positive.\n\nAm going to +2 anyway, and let you decide.",
      "parentUuid": "348d4697_0ad36c71",
      "range": {
        "startLine": 17,
        "startChar": 0,
        "endLine": 18,
        "endChar": 31
      },
      "revId": "db73a595754089414463a24eba20659617203087",
      "serverId": "aea13c4a-0b89-3eca-aee9-e193b1b77aa4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "de8aa3a6_a06f5e16",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 18,
      "author": {
        "id": 5050
      },
      "writtenOn": "2022-09-19T16:25:36Z",
      "side": 1,
      "message": "Thanks Antonio. I\u0027ll land this workaround for now and discuss it with Nicolas when he\u0027s back in the office.",
      "parentUuid": "b5ed029f_97087e9e",
      "range": {
        "startLine": 17,
        "startChar": 0,
        "endLine": 18,
        "endChar": 31
      },
      "revId": "db73a595754089414463a24eba20659617203087",
      "serverId": "aea13c4a-0b89-3eca-aee9-e193b1b77aa4"
    }
  ]
}