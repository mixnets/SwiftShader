{
  "comments": [
    {
      "key": {
        "uuid": "0170e138_95668f36",
        "filename": "/COMMIT_MSG",
        "patchSetId": 11
      },
      "lineNbr": 9,
      "author": {
        "id": 5005
      },
      "writtenOn": "2019-03-07T15:41:18Z",
      "side": 1,
      "message": "I find this highly confusing. When people refer to interleaved data in vertex buffers they mean position, texture coordinates, etc. are in array-of-structures layout. In other words data from each attribute is interleaved into one buffer. Non-interleaved would correspond to structure-of-arrays layout.\n\nThe latter maps to how we\u0027d process vertices in SIMD fashion. But it appears you\u0027re referring to non-lane-interleaved as meaning, well, interleaved.\n\nOrthogonal to this is how we actually pick the elements to process. For vertices, we currently process four consecutive indices, even if the index buffer doesn\u0027t contain consecutive indices. We cache the results and pick only the ones actually in the index buffer. The advantage is that we don\u0027t have to perform gather operations to read the attributes, but can use fixed-stride vector loads or even packed vector loads in case of non-interleaved vertex data. The disadvantages are that we need to avoid buffer overrun, and we still essentially perform a gather when reading out the cache and don\u0027t gain much from fixed-stride loads either. Also processing undefined vertex data gets tricky, so we may want to just do explicit gather operations: https://swiftshader-review.googlesource.com/4893\n\nAnyway, this confusion might be purely mine, and we can refactor later (where applicable to the code/comments) in case we agree on better jargon. Naming things is hard!",
      "range": {
        "startLine": 9,
        "startChar": 40,
        "endLine": 9,
        "endChar": 60
      },
      "revId": "f05c797c3bcb4b0d8d556afc8f5f81f6ded907e9",
      "serverId": "aea13c4a-0b89-3eca-aee9-e193b1b77aa4",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "315740db_171da859",
        "filename": "/COMMIT_MSG",
        "patchSetId": 11
      },
      "lineNbr": 9,
      "author": {
        "id": 7183
      },
      "writtenOn": "2019-03-07T16:46:43Z",
      "side": 1,
      "message": "Yes, I agree, this is a terrible name, and I really struggled to find a nice way to describe it.\n\nI drew a pretty ascii diagram to try and visualize this:\n\n\nA \u0027lane\u0027 is a component of a SIMD vector register (.x, .y, .z, .w). \nGiven 4 consecutive loads/stores of 4 SIMD vector registers:\n\n\n \"Lane-interleaved\":\n -------------------\n\n  Ptr+0:Reg0.x | Ptr+1:Reg0.y | Ptr+2:Reg0.z | Ptr+3:Reg0.w\n --------------+--------------+--------------+--------------\n  Ptr+4:Reg1.x | Ptr+5:Reg1.y | Ptr+6:Reg1.z | Ptr+7:Reg1.w\n --------------+--------------+--------------+--------------\n  Ptr+8:Reg2.x | Ptr+9:Reg2.y | Ptr+a:Reg2.z | Ptr+b:Reg2.w\n --------------+--------------+--------------+--------------\n  Ptr+c:Reg3.x | Ptr+d:Reg3.y | Ptr+e:Reg3.z | Ptr+f:Reg3.w\n\n \"Non-Lane-interleaved\":\n -----------------------\n\n  Ptr+0:Reg0.x | Ptr+0:Reg1.x | Ptr+0:Reg2.x | Ptr+0:Reg3.x\n --------------+--------------+--------------+--------------\n  Ptr+1:Reg0.y | Ptr+1:Reg1.y | Ptr+1:Reg2.y | Ptr+1:Reg3.y\n --------------+--------------+--------------+--------------\n  Ptr+2:Reg0.z | Ptr+2:Reg1.z | Ptr+2:Reg2.z | Ptr+2:Reg3.z\n --------------+--------------+--------------+--------------\n  Ptr+3:Reg0.w | Ptr+3:Reg1.w | Ptr+3:Reg2.w | Ptr+3:Reg3.w\n\n\nLooking at this, it\u0027s apparent that it isn\u0027t really about interleaving, more to do with replication into each of the registers.\n\nHappy to rename if you have something better.",
      "parentUuid": "0170e138_95668f36",
      "range": {
        "startLine": 9,
        "startChar": 40,
        "endLine": 9,
        "endChar": 60
      },
      "revId": "f05c797c3bcb4b0d8d556afc8f5f81f6ded907e9",
      "serverId": "aea13c4a-0b89-3eca-aee9-e193b1b77aa4",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "08d3e486_6f8238b4",
        "filename": "/COMMIT_MSG",
        "patchSetId": 11
      },
      "lineNbr": 9,
      "author": {
        "id": 7183
      },
      "writtenOn": "2019-03-07T17:12:55Z",
      "side": 1,
      "message": "Sorry, I\u0027ve just gone and confused the issue even more with a broken diagram.\n\nWill just put this (corrected) into the function\u0027s documentation.",
      "parentUuid": "315740db_171da859",
      "range": {
        "startLine": 9,
        "startChar": 40,
        "endLine": 9,
        "endChar": 60
      },
      "revId": "f05c797c3bcb4b0d8d556afc8f5f81f6ded907e9",
      "serverId": "aea13c4a-0b89-3eca-aee9-e193b1b77aa4",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "763fac8f_2998b6ec",
        "filename": "src/Pipeline/SpirvShader.hpp",
        "patchSetId": 11
      },
      "lineNbr": 227,
      "author": {
        "id": 5005
      },
      "writtenOn": "2019-03-07T15:41:18Z",
      "side": 1,
      "message": "I think this name is very confusing because \"physical pointers\" is referred to by the SPIR-V spec as part of non-Logical addressing models, while Appendix A of the Vulkan spec states that \"The Logical addressing model must be selected.\"\n\nAnyway, since this is easy to refactor once we find a better name I\u0027m fine with landing it as-is.",
      "range": {
        "startLine": 227,
        "startChar": 4,
        "endLine": 227,
        "endChar": 19
      },
      "revId": "f05c797c3bcb4b0d8d556afc8f5f81f6ded907e9",
      "serverId": "aea13c4a-0b89-3eca-aee9-e193b1b77aa4",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0a4d7530_9ba25397",
        "filename": "src/Pipeline/SpirvShader.hpp",
        "patchSetId": 11
      },
      "lineNbr": 227,
      "author": {
        "id": 7183
      },
      "writtenOn": "2019-03-07T16:46:43Z",
      "side": 1,
      "message": "It\u0027s not selected by the SPIR-V, but equates to almost exactly the same thing.\nAgain, happy to rename if you can think of a better name.",
      "parentUuid": "763fac8f_2998b6ec",
      "range": {
        "startLine": 227,
        "startChar": 4,
        "endLine": 227,
        "endChar": 19
      },
      "revId": "f05c797c3bcb4b0d8d556afc8f5f81f6ded907e9",
      "serverId": "aea13c4a-0b89-3eca-aee9-e193b1b77aa4",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3e1a75ad_cd64f764",
        "filename": "src/Pipeline/SpirvShader.hpp",
        "patchSetId": 11
      },
      "lineNbr": 227,
      "author": {
        "id": 5005
      },
      "writtenOn": "2019-03-07T18:47:42Z",
      "side": 1,
      "message": "BufferPointer works for me.\n\nBuffers are the only shader resources with a memory layout that isn\u0027t opaque, so pointer arithmetic is valid on them.",
      "parentUuid": "0a4d7530_9ba25397",
      "range": {
        "startLine": 227,
        "startChar": 4,
        "endLine": 227,
        "endChar": 19
      },
      "revId": "f05c797c3bcb4b0d8d556afc8f5f81f6ded907e9",
      "serverId": "aea13c4a-0b89-3eca-aee9-e193b1b77aa4",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "386324ec_95104446",
        "filename": "src/Pipeline/SpirvShader.hpp",
        "patchSetId": 11
      },
      "lineNbr": 227,
      "author": {
        "id": 7183
      },
      "writtenOn": "2019-03-07T20:22:40Z",
      "side": 1,
      "message": "\u003e Buffers are the only shader resources with a memory layout that isn\u0027t opaque\n\nExcept Chris and I were discussing earlier using these pointers for push constants...",
      "parentUuid": "3e1a75ad_cd64f764",
      "range": {
        "startLine": 227,
        "startChar": 4,
        "endLine": 227,
        "endChar": 19
      },
      "revId": "f05c797c3bcb4b0d8d556afc8f5f81f6ded907e9",
      "serverId": "aea13c4a-0b89-3eca-aee9-e193b1b77aa4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fbf01c83_0e46eb07",
        "filename": "src/Pipeline/SpirvShader.hpp",
        "patchSetId": 11
      },
      "lineNbr": 227,
      "author": {
        "id": 5005
      },
      "writtenOn": "2019-03-07T21:25:53Z",
      "side": 1,
      "message": "Still happy to land this as-is and change later.\n\n(I think push constants should be the same as uniform buffers from the SPIR-V implementation perspective. So no need to discern between them here.)",
      "parentUuid": "386324ec_95104446",
      "range": {
        "startLine": 227,
        "startChar": 4,
        "endLine": 227,
        "endChar": 19
      },
      "revId": "f05c797c3bcb4b0d8d556afc8f5f81f6ded907e9",
      "serverId": "aea13c4a-0b89-3eca-aee9-e193b1b77aa4",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "997573e1_4c9162ac",
        "filename": "src/Pipeline/SpirvShader.hpp",
        "patchSetId": 11
      },
      "lineNbr": 389,
      "author": {
        "id": 5005
      },
      "writtenOn": "2019-03-07T15:41:18Z",
      "side": 1,
      "message": "linearly?",
      "range": {
        "startLine": 389,
        "startChar": 37,
        "endLine": 389,
        "endChar": 46
      },
      "revId": "f05c797c3bcb4b0d8d556afc8f5f81f6ded907e9",
      "serverId": "aea13c4a-0b89-3eca-aee9-e193b1b77aa4",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "38f1a212_82a705f0",
        "filename": "src/Pipeline/SpirvShader.hpp",
        "patchSetId": 11
      },
      "lineNbr": 389,
      "author": {
        "id": 7183
      },
      "writtenOn": "2019-03-07T17:12:55Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "997573e1_4c9162ac",
      "range": {
        "startLine": 389,
        "startChar": 37,
        "endLine": 389,
        "endChar": 46
      },
      "revId": "f05c797c3bcb4b0d8d556afc8f5f81f6ded907e9",
      "serverId": "aea13c4a-0b89-3eca-aee9-e193b1b77aa4",
      "unresolved": false
    }
  ]
}