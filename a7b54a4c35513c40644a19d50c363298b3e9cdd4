{
  "comments": [
    {
      "key": {
        "uuid": "7be27988_77c5b66f",
        "filename": "src/Pipeline/SpirvShader.cpp",
        "patchSetId": 1
      },
      "lineNbr": 6110,
      "author": {
        "id": 5005
      },
      "writtenOn": "2019-06-13T16:06:49Z",
      "side": 1,
      "message": "I think we should test whether static_cast\u003cint32_t\u003e(l) % static_cast\u003cint32_t\u003e(r) will be negative, instead. It\u0027s easier to read the intent that way. While a multiplication is slightly cheaper, this operation is rare and it\u0027s for constant propagation so no recurring cost.",
      "range": {
        "startLine": 6109,
        "startChar": 4,
        "endLine": 6110,
        "endChar": 36
      },
      "revId": "a7b54a4c35513c40644a19d50c363298b3e9cdd4",
      "serverId": "aea13c4a-0b89-3eca-aee9-e193b1b77aa4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "25d1f62a_52d84ffd",
        "filename": "src/Pipeline/SpirvShader.cpp",
        "patchSetId": 1
      },
      "lineNbr": 6110,
      "author": {
        "id": 5050
      },
      "writtenOn": "2019-06-13T17:16:16Z",
      "side": 1,
      "message": "It\u0027s probably equivalent to:\nv \u003d static_cast\u003cint32_t\u003e(l) % static_cast\u003cint32_t\u003e(r);\nif((v \u0026 0x80000000) !\u003d 0) v \u003d static_cast\u003cint32_t\u003e(v) + r;",
      "parentUuid": "7be27988_77c5b66f",
      "range": {
        "startLine": 6109,
        "startChar": 4,
        "endLine": 6110,
        "endChar": 36
      },
      "revId": "a7b54a4c35513c40644a19d50c363298b3e9cdd4",
      "serverId": "aea13c4a-0b89-3eca-aee9-e193b1b77aa4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6c3619eb_8068a6dc",
        "filename": "src/Pipeline/SpirvShader.cpp",
        "patchSetId": 1
      },
      "lineNbr": 6110,
      "author": {
        "id": 9035
      },
      "writtenOn": "2019-06-13T18:14:19Z",
      "side": 1,
      "message": "C\u0027s modulo doesn\u0027t have the same sign as a multiply:\n \n+-----+-----+-----+-----+------------+\n|  A  |  B  | A*B | A%B | A OpSMod B |\n+-----+-----+-----+-----+------------+\n|  10 |  3  |  30 |  1  |     1      |\n+-----+-----+-----+-----+------------+\n|  10 | -3  | -30 |  1  |    -2      |\n+-----+-----+-----+-----+------------+\n| -10 |  3  | -30 | -1  |     2      |\n+-----+-----+-----+-----+------------+\n| -10 | -3  |  30 | -1  |    -1      |\n+-----+-----+-----+-----+------------+\n\nAccording to the SPIR-V spec, OpSMod\u0027s result \"is the remainder r of Operand 1 divided by Operand 2 where if r !\u003d 0, the sign of r is the same as the sign of Operand 2.\"\n\nSo this code needs to test the sign of the multiply.",
      "parentUuid": "7be27988_77c5b66f",
      "range": {
        "startLine": 6109,
        "startChar": 4,
        "endLine": 6110,
        "endChar": 36
      },
      "revId": "a7b54a4c35513c40644a19d50c363298b3e9cdd4",
      "serverId": "aea13c4a-0b89-3eca-aee9-e193b1b77aa4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a8a55d17_22cb39b5",
        "filename": "src/Pipeline/SpirvShader.cpp",
        "patchSetId": 1
      },
      "lineNbr": 6110,
      "author": {
        "id": 9035
      },
      "writtenOn": "2019-06-13T18:21:48Z",
      "side": 1,
      "message": "Actually, there are likely issues with overflow on integer multiplies that aren\u0027t being tested. What we want is something similar to:\n \nv \u003d static_cast\u003cint32_t\u003e(l) % static_cast\u003cint32_t\u003e(r);\nif((v \u0026 0x80000000) !\u003d (r \u0026 0x80000000)) v \u003d static_cast\u003cint32_t\u003e(v) + r;",
      "parentUuid": "6c3619eb_8068a6dc",
      "range": {
        "startLine": 6109,
        "startChar": 4,
        "endLine": 6110,
        "endChar": 36
      },
      "revId": "a7b54a4c35513c40644a19d50c363298b3e9cdd4",
      "serverId": "aea13c4a-0b89-3eca-aee9-e193b1b77aa4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7953f31c_222fd4bb",
        "filename": "src/Pipeline/SpirvShader.cpp",
        "patchSetId": 1
      },
      "lineNbr": 6110,
      "author": {
        "id": 5050
      },
      "writtenOn": "2019-06-13T18:22:38Z",
      "side": 1,
      "message": "If it\u0027s just a sign copy, then isn\u0027t it equivalent to:\nv \u003d (r \u0026 0x80000000) | ((static_cast\u003cint32_t\u003e(l) % static_cast\u003cint32_t\u003e(r)) \u0026 0x7FFFFFFF);",
      "parentUuid": "6c3619eb_8068a6dc",
      "range": {
        "startLine": 6109,
        "startChar": 4,
        "endLine": 6110,
        "endChar": 36
      },
      "revId": "a7b54a4c35513c40644a19d50c363298b3e9cdd4",
      "serverId": "aea13c4a-0b89-3eca-aee9-e193b1b77aa4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5f3a5686_099a46f7",
        "filename": "src/Pipeline/SpirvShader.cpp",
        "patchSetId": 1
      },
      "lineNbr": 6110,
      "author": {
        "id": 5050
      },
      "writtenOn": "2019-06-13T18:24:10Z",
      "side": 1,
      "message": "Never mind, I\u0027m missing the +r part.",
      "parentUuid": "7953f31c_222fd4bb",
      "range": {
        "startLine": 6109,
        "startChar": 4,
        "endLine": 6110,
        "endChar": 36
      },
      "revId": "a7b54a4c35513c40644a19d50c363298b3e9cdd4",
      "serverId": "aea13c4a-0b89-3eca-aee9-e193b1b77aa4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "802fdad2_db986757",
        "filename": "src/Pipeline/SpirvShader.cpp",
        "patchSetId": 1
      },
      "lineNbr": 6110,
      "author": {
        "id": 5005
      },
      "writtenOn": "2019-06-13T19:08:29Z",
      "side": 1,
      "message": "Thanks for double-checking that Sean!",
      "parentUuid": "5f3a5686_099a46f7",
      "range": {
        "startLine": 6109,
        "startChar": 4,
        "endLine": 6110,
        "endChar": 36
      },
      "revId": "a7b54a4c35513c40644a19d50c363298b3e9cdd4",
      "serverId": "aea13c4a-0b89-3eca-aee9-e193b1b77aa4",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6015114a_2ceea044",
        "filename": "src/Pipeline/SpirvShader.cpp",
        "patchSetId": 1
      },
      "lineNbr": 6110,
      "author": {
        "id": 5005
      },
      "writtenOn": "2019-06-13T19:10:28Z",
      "side": 1,
      "message": "Wait, l and r are still unsigned, so shouldn\u0027t it be \"if ((((int)l * (int)r) \u0026 0x80000000) !\u003d 0)\" ?",
      "parentUuid": "802fdad2_db986757",
      "range": {
        "startLine": 6109,
        "startChar": 4,
        "endLine": 6110,
        "endChar": 36
      },
      "revId": "a7b54a4c35513c40644a19d50c363298b3e9cdd4",
      "serverId": "aea13c4a-0b89-3eca-aee9-e193b1b77aa4",
      "unresolved": true
    }
  ]
}