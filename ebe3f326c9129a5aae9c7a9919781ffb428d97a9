{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "864b335f_fdd3b2de",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 8
      },
      "lineNbr": 0,
      "author": {
        "id": 5050
      },
      "writtenOn": "2021-02-10T21:55:35Z",
      "side": 1,
      "message": "Fixed the ImageView\u0027s ID so that sampler cache key doesn\u0027t match between an ImageView with a single mip level and one with multiple mip levels.",
      "revId": "ebe3f326c9129a5aae9c7a9919781ffb428d97a9",
      "serverId": "aea13c4a-0b89-3eca-aee9-e193b1b77aa4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4beb6df1_0ca4c3ad",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 8
      },
      "lineNbr": 0,
      "author": {
        "id": 5050
      },
      "writtenOn": "2021-02-10T22:09:49Z",
      "side": 1,
      "message": "Local testing showed a significant improvement for the TriangleSampleTexture/TriangleSampleTexture benchmark\u0027s average time, which went from ~2.06ms to ~1.33ms, in local testing, so this is about a 33% gain for that case.",
      "revId": "ebe3f326c9129a5aae9c7a9919781ffb428d97a9",
      "serverId": "aea13c4a-0b89-3eca-aee9-e193b1b77aa4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c49023fd_70f17570",
        "filename": "src/Pipeline/SamplerCore.cpp",
        "patchSetId": 8
      },
      "lineNbr": 105,
      "author": {
        "id": 5005
      },
      "writtenOn": "2021-02-11T16:10:42Z",
      "side": 1,
      "message": "What about these cases? If the shader provides Lod, but there\u0027s only a single level, we could still take advantage of both the constant propagation and eliminating any calculation the shader, if we substitute our fixed lod here.",
      "range": {
        "startLine": 94,
        "startChar": 1,
        "endLine": 105,
        "endChar": 6
      },
      "revId": "ebe3f326c9129a5aae9c7a9919781ffb428d97a9",
      "serverId": "aea13c4a-0b89-3eca-aee9-e193b1b77aa4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "84de86a3_4bee3fc2",
        "filename": "src/Pipeline/SamplerCore.cpp",
        "patchSetId": 8
      },
      "lineNbr": 105,
      "author": {
        "id": 5005
      },
      "writtenOn": "2021-02-11T16:10:42Z",
      "side": 1,
      "message": "Isn\u0027t what we\u0027re doing here essentially the Base case? Our table in sw::Texture gets filled with the same data for each level if there\u0027s just a single one, even if mindLod \u003e 0, so we can always use 0 as the effective index.",
      "range": {
        "startLine": 105,
        "startChar": 21,
        "endLine": 105,
        "endChar": 25
      },
      "revId": "ebe3f326c9129a5aae9c7a9919781ffb428d97a9",
      "serverId": "aea13c4a-0b89-3eca-aee9-e193b1b77aa4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2242867e_dff54939",
        "filename": "src/Pipeline/SamplerCore.cpp",
        "patchSetId": 8
      },
      "lineNbr": 105,
      "author": {
        "id": 5050
      },
      "writtenOn": "2021-02-11T16:27:54Z",
      "side": 1,
      "message": "Right, but this cl would also apply the optimization when having a constant mip level that\u0027s not 0. Not sure if that\u0027s useful, though.",
      "parentUuid": "84de86a3_4bee3fc2",
      "range": {
        "startLine": 105,
        "startChar": 21,
        "endLine": 105,
        "endChar": 25
      },
      "revId": "ebe3f326c9129a5aae9c7a9919781ffb428d97a9",
      "serverId": "aea13c4a-0b89-3eca-aee9-e193b1b77aa4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "60df657d_bc2d4e93",
        "filename": "src/Pipeline/SamplerCore.cpp",
        "patchSetId": 8
      },
      "lineNbr": 105,
      "author": {
        "id": 5050
      },
      "writtenOn": "2021-02-11T16:27:54Z",
      "side": 1,
      "message": "All we\u0027d save here is a + operation in the Lod operation, since the clamp still happens below (line 119-120).\nThe Fetch function currently doesn\u0027t apply the clamp at line 119-120, so I didn\u0027t want to clamp it. Should it apply the clamp too?",
      "parentUuid": "c49023fd_70f17570",
      "range": {
        "startLine": 94,
        "startChar": 1,
        "endLine": 105,
        "endChar": 6
      },
      "revId": "ebe3f326c9129a5aae9c7a9919781ffb428d97a9",
      "serverId": "aea13c4a-0b89-3eca-aee9-e193b1b77aa4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "01092458_54fc6274",
        "filename": "src/Pipeline/SpirvShaderSampling.cpp",
        "patchSetId": 8
      },
      "lineNbr": 83,
      "author": {
        "id": 5005
      },
      "writtenOn": "2021-02-11T16:10:42Z",
      "side": 1,
      "message": "As noted in another comment, can we just do samplerState.compareEnable \u003d Base instead?",
      "range": {
        "startLine": 83,
        "startChar": 3,
        "endLine": 83,
        "endChar": 5
      },
      "revId": "ebe3f326c9129a5aae9c7a9919781ffb428d97a9",
      "serverId": "aea13c4a-0b89-3eca-aee9-e193b1b77aa4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ec76fb90_d8b77bbf",
        "filename": "src/Pipeline/SpirvShaderSampling.cpp",
        "patchSetId": 8
      },
      "lineNbr": 83,
      "author": {
        "id": 5050
      },
      "writtenOn": "2021-02-11T16:27:54Z",
      "side": 1,
      "message": "samplerState.compareEnable is a bool\ndid you mean:\ninstruction.samplerMethod \u003d Base\n?\nIf so, that should probably be done before the routine key is generated, since a different input samplerMethod wouldn\u0027t end up generating a different image sampler routine.",
      "parentUuid": "01092458_54fc6274",
      "range": {
        "startLine": 83,
        "startChar": 3,
        "endLine": 83,
        "endChar": 5
      },
      "revId": "ebe3f326c9129a5aae9c7a9919781ffb428d97a9",
      "serverId": "aea13c4a-0b89-3eca-aee9-e193b1b77aa4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b8dc6761_3143da08",
        "filename": "src/Vulkan/VkImageView.hpp",
        "patchSetId": 8
      },
      "lineNbr": 35,
      "author": {
        "id": 5005
      },
      "writtenOn": "2021-02-11T16:10:42Z",
      "side": 1,
      "message": "Looks like it might be a mistake to pass in an Image here, instead of an ImageView? We should be able to obtain the `hasMultipleMipLevels` info from the latter, and eliminate the explicit parameter here.\n\nIn fact that would allow eliminating every other parameter here?",
      "range": {
        "startLine": 35,
        "startChar": 12,
        "endLine": 35,
        "endChar": 30
      },
      "revId": "ebe3f326c9129a5aae9c7a9919781ffb428d97a9",
      "serverId": "aea13c4a-0b89-3eca-aee9-e193b1b77aa4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "23ba0746_29e42c6c",
        "filename": "src/Vulkan/VkImageView.hpp",
        "patchSetId": 8
      },
      "lineNbr": 35,
      "author": {
        "id": 5050
      },
      "writtenOn": "2021-02-11T16:27:54Z",
      "side": 1,
      "message": "This is called inside the ImageView\u0027s constructor, so it doesn\u0027t exist yet.",
      "parentUuid": "b8dc6761_3143da08",
      "range": {
        "startLine": 35,
        "startChar": 12,
        "endLine": 35,
        "endChar": 30
      },
      "revId": "ebe3f326c9129a5aae9c7a9919781ffb428d97a9",
      "serverId": "aea13c4a-0b89-3eca-aee9-e193b1b77aa4"
    }
  ]
}